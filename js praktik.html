<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
 <script>
    // Enable class-based dark mode for Tailwind (must be set before loading the CDN)
    window.tailwind = window.tailwind || {}
    window.tailwind.config = window.tailwind.config || {}
    window.tailwind.config.darkMode = 'class'
  </script>
<script type="tailwind-config">
{
  "darkMode": "class"
}
</script>

 <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <title>Document</title>
 
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-900 to-green-600 dark:from-gray-900 dark:to-black font-mono">

  <div class="flex justify-center mt-4">
    <button id="toggle-dark"
  class="px-4 py-2 bg-black/20 dark:bg-white/20 text-black dark:text-white rounded-lg hover:bg-black/30 dark:hover:bg-white/30 transition">Toggle Dark Mode
</button>
</div>

  <h1 class="text-white text-center pt-6 text-4xl font-bold">Note App</h1>

  <p class="text-center text-white text-lg mb-6">Double click on a note to remove it</p>

  <div id="app" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-10 justify-center p-12">
    <button id="btn"
   class="h-52 border border-white/40 bg-white/30 rounded-lg text-6xl font-bold text-black/30 cursor-pointer hover:bg-white/60 hover:text-black/60 transition-all flex items-center justify-center" >
   +
  </button>
  </div>
<script>
  let btn = document.getElementById('btn')
  let app = document.getElementById('app')
  // localStorage helpers (define before use)
  function getNotes(){
    return JSON.parse(localStorage.getItem('notes') || '[]')
  }

  function saveNotes(notes){
    localStorage.setItem('notes', JSON.stringify(notes))
  }

  // render existing notes
  getNotes().forEach((note) => {
    let noteElement = createNoteElement(note.id, note.content)
    app.insertBefore(noteElement, btn)
  })

  function createNoteElement(id, content) {
    let element = document.createElement('textarea')
    // Tailwind classes for appearance
    element.className = 'note w-full bg-white dark:bg-gray-800 p-4 rounded-lg min-h-[120px] text-black dark:text-white resize-none focus:outline-none border border-white/10 dark:border-gray-600'
    element.placeholder = 'Empty Note'
    element.value = content
    element.rows = 6

    element.addEventListener('dblclick', () => {
      let warning = confirm('Do you want to delete this note?')
      if(warning){
        deleteNote(id, element)
      }
    })

 element.addEventListener('input', () =>{
  updateNote(id, element.value)
 })
 return element
  }

  function deleteNote(id, element){
    let notes = getNotes().filter((note) => note.id != id)
    saveNotes(notes)
    app.removeChild(element)
  }

  function updateNote(id, content){
    let notes = getNotes()
    let target = notes.filter((note) => note.id == id)[0]
    target.content = content 
    saveNotes(notes)
  }
  function addNote(){
    let notes = getNotes()
    let noteObject = {
      id: Math.floor(Math.random()*100000),
      content: ''
    }
    let noteElement = createNoteElement(noteObject.id, noteObject.content)
    app.insertBefore(noteElement, btn)

    notes.push(noteObject)
    saveNotes(notes)
  }
  btn.addEventListener('click', () => addNote())

</script>
<script>
  // Theme (dark mode) initialization and toggle
  (function() {
    const toggle = document.getElementById('toggle-dark')
    const userPref = localStorage.getItem('theme')
    const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches

    function applyTheme(theme) {
      if (theme === 'dark') {
        document.documentElement.classList.add('dark')
        toggle.textContent = 'Switch to Light'
      } else {
        document.documentElement.classList.remove('dark')
        toggle.textContent = 'Switch to Dark'
      }
    }

    // initial
    if (userPref) {
      applyTheme(userPref)
    } else {
      applyTheme(prefersDark ? 'dark' : 'light')
    }

    toggle.addEventListener('click', () => {
      const isDark = document.documentElement.classList.toggle('dark')
      const theme = isDark ? 'dark' : 'light'
      localStorage.setItem('theme', theme)
      applyTheme(theme)
    })
  })()
</script>
  
</body>
</html>